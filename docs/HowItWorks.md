#   How It Works: EXT4 File Recovery Process

This document provides a detailed, step-by-step explanation of the file recovery process implemented in this project. The process is divided into three main stages, each corresponding to one of the provided Bash scripts: virtual disk setup, simulated file deletion, and file recovery.

##   1. Virtual Disk Creation and Population (`populate_vd.sh`)

The `populate_vd.sh` script is responsible for setting up the environment for the file recovery demonstration. It performs the following actions:

1.  **Image Creation:** A virtual disk image named `test_ext4.img` is created using the `dd` command. This command allocates a specified amount of disk space by writing a sequence of zeros to a file, effectively simulating a raw disk. In this case, the image is created with a size of 2048MB.
2.  **Formatting:** The newly created disk image is formatted with the EXT4 file system using the `mkfs.ext4` command. This prepares the disk to store files and directories by creating the necessary file system structures, such as the superblock and inode table.
3.  **Mounting:** The disk image is mounted to the directory `/mnt/test_ext4` using the `mount` command in conjunction with `losetup`. `losetup` creates a loop device, which allows the disk image to be treated as a block device, making it accessible to the operating system.
4.  **File Creation:** The script then populates the mounted file system with a variety of test files:
    * Text files (`file1.txt`, `file2.txt`, `file3.txt`): These files contain simple text strings to demonstrate the recovery of textual data. `file3.txt` includes the unique string "This is a very unique line to be recovered later 123ABCxyz!", which is used later for file carving.
    * Random data files (`file4.txt`, `file5.txt`): These files are filled with random data generated by `/dev/urandom` to simulate more complex file content.
    * Executable file (`ls_copy`): A copy of the `ls` command is included to represent executable files.
    * Image file (`wp1817964-interstellar-wallpapers.jpg`): An image file is added to test the recovery of binary data.
    * Directory with a hidden file (`folder1/secret.txt`): A directory containing a text file is created to test the recovery of directory structures and hidden files.
5.  **Synchronization:** The `sync` command is used to ensure that all data is written to the disk image before proceeding.

##   2. Simulating File Deletion (`dummy_deletion.sh`)

The `dummy_deletion.sh` script simulates the deletion of several files and directories from the mounted file system. Specifically, it removes:

* `file1.txt`
* `folder1/secret.txt`
* `ls_copy`
* `wp1817964-interstellar-wallpapers.jpg`
* `file3.txt`

This deletion is performed using the `rm` command, which removes the directory entries pointing to the file data. However, the actual data blocks of the files may still remain on the disk, providing an opportunity for recovery.

##   3. File Recovery (`recover.sh`)

The `recover.sh` script attempts to recover the deleted files. It employs several techniques:

1.  **Unmounting:** The disk image is unmounted to ensure data consistency during the recovery process.
2.  **`fls` for Inode Listing:** The `fls` command from TSK is used to list the inodes of the deleted files. `fls` analyzes the file system metadata to identify inodes that are no longer associated with active files. The `-r` and `-d` flags are used to recursively search the image and show only deleted files.
3.  **Inode-based Recovery with `icat`:** The script iterates through the output of `fls`, extracting the inode number for each deleted file. For each identified inode, the `icat` command (also from TSK) is used to attempt to recover the file's content. `icat` retrieves the data associated with a specific inode.
4.  **File Carving:** The script performs a basic file carving operation by searching the disk image for the unique string "123ABCxyz!" using the `grep` command. If the string is found, the script uses `dd` to extract a block of data containing the string. This demonstrates a simple form of raw data recovery, where file content is recovered without relying on file system metadata.

This recovery process reflects the fundamental principles of digital forensics: using file system metadata to locate deleted files and employing data carving techniques to recover data directly from the disk.
